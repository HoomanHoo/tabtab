<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Search">
    <select id="getCount" resultType="int">
        select count(*) from medi_information
        where medi_name like '%' || #{keyword} || '%' or chief_ingre like '%' || #{keyword} || '%'
    </select>
    
    <select id="getSearch" parameterType="map" resultType="search.SearchDataBean">
        select num, medi_name, supply_value, selling_price, manu_com, chief_ingre, vari_code, reg_date
        from medi_information mi, medi_variation mv
        where mi.medi_code= mv.medi_code
        and num= #{num}   
    </select>
    
    <select id="getSearchList" parameterType="map" resultType="search.SearchDataBean">   
        select rownum r, num, medi_name, supply_value, selling_price, manu_com, chief_ingre, vari_code, reg_date  
		from (select*from medi_information where medi_name like '%' || #{keyword} || '%' or chief_ingre like '%' || #{keyword} || '%'
		order by medi_name desc))
		where r &gt;=#{start} and r &lt;=#{end} 	
    </select>
    
 <!--   <select id="searchByKeyword" parameterType="map" resultType="search.SearchDataBean">
        select rownum r, num, medi_name, supply_value, selling_price, manu_com, chief_ingre, vari_code, reg_date
        from (select*from medi_information where medi_name like '%' || #{keyword} || '%' order by medi_name desc)
        where r &gt;=#{start} and r &lt;=#{end}
    </select>
  --> 
    <!-- medi_information mi, medi_variation mv 
		where mi.medi_code = mv.medi_code 
		order by medi_name desc 
		offset #{start} rows fetch next #{count} rows only -->
      <!--  Mapped Statements collection already contains value for Search.getSearchList. please check search/search.xml and search/search.xml 에러 발생   -->
 <!--   <select id="getSearchList" parameterType="map" resultType="search.SearchDataBean">
        select * from (
            select rownum r, num, medi_name, supply_value, selling_price, manu_com, chief_ingre, vari_code, reg_date
            from(
                select * from medi_information
                where medi_name like '%' || #{keyword} || '%' 
                order by medi_name desc
            )
        ) where r where r &gt;= #{start} and r &lt;= #{end}       
    </select>  
    
    <select id="getSearchList" parameterType="map" resultType="search.SearchDataBean">
        select * from (
            select rownum r, num, medi_name, supply_value, selling_price, manu_com, chief_ingre, vari_code, reg_date
            from(
                select * from medi_information
                where chief_ingre like '%' || #{keyword} || '%'
                order by medi_name desc
            )
        ) where r where r &gt;= #{start} and r &lt;= #{end}       
    </select>    -->
  
      
</mapper>